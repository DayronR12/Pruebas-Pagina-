<button (click)="cerrarSesion()">Cerrar sesión</button>

<form [formGroup]="registroForm" (ngSubmit)="onSubmit()">
  <div>
    <label for="nit">NIT</label>
    <input id="nit" formControlName="nit" type="text" placeholder="NIT" />
    <div *ngIf="registroForm.get('nit')!.invalid && (registroForm.get('nit')!.dirty || registroForm.get('nit')!.touched)">
      <small *ngIf="registroForm.get('nit')!.errors?.['required']">El NIT es requerido.</small>
      <small *ngIf="registroForm.get('nit')!.errors?.['pattern']">El NIT debe ser de 10 dígitos numéricos.</small>
    </div>
  </div>

  <div>
    <label for="primerNombre">Primer Nombre</label>
    <input id="primerNombre" formControlName="primerNombre" type="text" placeholder="Primer Nombre" />
    <div *ngIf="registroForm.get('primerNombre')!.invalid && (registroForm.get('primerNombre')!.dirty || registroForm.get('primerNombre')!.touched)">
      <small *ngIf="registroForm.get('primerNombre')!.errors?.['required']">El primer nombre es requerido.</small>
      <small *ngIf="registroForm.get('primerNombre')!.errors?.['maxlength']">El primer nombre no puede tener más de 20 caracteres.</small>
      <small *ngIf="registroForm.get('primerNombre')!.errors?.['pattern']">El primer nombre solo puede contener letras.</small>
    </div>
  </div>

  <div>
    <label for="segundoNombre">Segundo Nombre</label>
    <input id="segundoNombre" formControlName="segundoNombre" type="text" placeholder="Segundo Nombre" />
    <div *ngIf="registroForm.get('segundoNombre')!.invalid && (registroForm.get('segundoNombre')!.dirty || registroForm.get('segundoNombre')!.touched)">
      <small *ngIf="registroForm.get('segundoNombre')!.errors?.['maxlength']">El segundo nombre no puede tener más de 20 caracteres.</small>
      <small *ngIf="registroForm.get('segundoNombre')!.errors?.['pattern']">El segundo nombre solo puede contener letras.</small>
    </div>
  </div>

  <div>
    <label for="primerApellido">Primer Apellido</label>
    <input id="primerApellido" formControlName="primerApellido" type="text" placeholder="Primer Apellido" />
    <div *ngIf="registroForm.get('primerApellido')!.invalid && (registroForm.get('primerApellido')!.dirty || registroForm.get('primerApellido')!.touched)">
      <small *ngIf="registroForm.get('primerApellido')!.errors?.['required']">El primer apellido es requerido.</small>
      <small *ngIf="registroForm.get('primerApellido')!.errors?.['maxlength']">El primer apellido no puede tener más de 20 caracteres.</small>
      <small *ngIf="registroForm.get('primerApellido')!.errors?.['pattern']">El primer apellido solo puede contener letras.</small>
    </div>
  </div>

  <div>
    <label for="segundoApellido">Segundo Apellido</label>
    <input id="segundoApellido" formControlName="segundoApellido" type="text" placeholder="Segundo Apellido" />
    <div *ngIf="registroForm.get('segundoApellido')!.invalid && (registroForm.get('segundoApellido')!.dirty || registroForm.get('segundoApellido')!.touched)">
      <small *ngIf="registroForm.get('segundoApellido')!.errors?.['maxlength']">El segundo apellido no puede tener más de 20 caracteres.</small>
      <small *ngIf="registroForm.get('segundoApellido')!.errors?.['pattern']">El segundo apellido solo puede contener letras.</small>
    </div>
  </div>

  <div>
    <label for="fechaNacimiento">Fecha de Nacimiento</label>
    <input id="fechaNacimiento" formControlName="fechaNacimiento" type="date" placeholder="Fecha de Nacimiento" />
    <div *ngIf="registroForm.get('fechaNacimiento')!.invalid && (registroForm.get('fechaNacimiento')!.dirty || registroForm.get('fechaNacimiento')!.touched)">
      <small *ngIf="registroForm.get('fechaNacimiento')!.errors?.['required']">La fecha de nacimiento es requerida.</small>
    </div>
  </div>

  <div>
    <label for="telefono">Teléfono</label>
    <input id="telefono" formControlName="telefono" type="text" placeholder="Teléfono" />
    <div *ngIf="registroForm.get('telefono')!.invalid && (registroForm.get('telefono')!.dirty || registroForm.get('telefono')!.touched)">
      <small *ngIf="registroForm.get('telefono')!.errors?.['required']">El teléfono es requerido.</small>
      <small *ngIf="registroForm.get('telefono')!.errors?.['pattern']">El teléfono debe tener 10 dígitos numéricos.</small>
    </div>
  </div>

  <div>
    <label for="email">Email</label>
    <input id="email" formControlName="email" type="email" placeholder="Email" />
    <div *ngIf="registroForm.get('email')!.invalid && (registroForm.get('email')!.dirty || registroForm.get('email')!.touched)">
      <small *ngIf="registroForm.get('email')!.errors?.['required']">El email es requerido.</small>
      <small *ngIf="registroForm.get('email')!.errors?.['email']">El formato del email no es válido.</small>
    </div>
  </div>

  <div>
    <label for="usuario">Usuario</label>
    <input id="usuario" formControlName="usuario" type="text" placeholder="Usuario" />
    <div *ngIf="registroForm.get('usuario')!.invalid && (registroForm.get('usuario')!.dirty || registroForm.get('usuario')!.touched)">
      <small *ngIf="registroForm.get('usuario')!.errors?.['required']">El usuario es requerido.</small>
    </div>
  </div>

  <div>
    <label for="clave">Clave:</label>
    <input id="clave" type="password" formControlName="clave" placeholder="Clave" />
    <div *ngIf="registroForm.get('clave')!.invalid && (registroForm.get('clave')!.touched || registroForm.get('clave')!.dirty)">
      <div *ngIf="registroForm.get('clave')!.errors?.['required']">La clave es requerida.</div>
      <div *ngIf="registroForm.get('clave')!.errors?.['minlength']">La clave debe tener al menos 8 caracteres.</div>
    </div>
  </div>

  <button type="submit">{{ usuarioSeleccionado ? 'Actualizar' : 'Registrar' }}</button>
  <button type="button" (click)="usuarioSeleccionado = undefined; registroForm.reset()">Limpiar</button>
</form>

<h3>Lista de Usuarios</h3>
<table border="1">
  <thead>
    <tr>
      <th>NIT</th>
      <th>Primer Nombre</th>
      <th>Segundo Nombre</th>
      <th>Primer Apellido</th>
      <th>Segundo Apellido</th>
      <th>Fecha de Nacimiento</th>
      <th>Teléfono</th>
      <th>Email</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let usuario of usuarios">
      <td>{{ usuario.nit }}</td>
      <td>{{ usuario.primerNombre }}</td>
      <td>{{ usuario.segundoNombre }}</td>
      <td>{{ usuario.primerApellido }}</td>
      <td>{{ usuario.segundoApellido }}</td>
      <td>{{ usuario.fechaNacimiento | date }}</td>
      <td>{{ usuario.telefono }}</td>
      <td>{{ usuario.email }}</td>
      <td>
        <button (click)="editUsuario(usuario)">Editar</button>
        <button *ngIf="usuario.id !== undefined" (click)="deleteUsuario(usuario.id)">Eliminar</button>
      </td>
    </tr>
  </tbody>
</table>
